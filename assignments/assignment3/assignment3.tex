\newif\ifshowsolutions
\showsolutionsfalse
\input{../common/preamble}

\chead{
  {\vbox{
      \vspace{2mm}
      \large
      Computational Physics II \hfill
      UCSD PHYS 142/242 \hfill \\[1pt]
      Assignment 3\hfill
      Draft version due: Friday, February 23, 2024, 8:00pm\\
	  \hfill
	  Corrected version due: Wednesday, February 28, 2024, 8:00pm\\
    }
  }
}

\begin{document}
\pagestyle{fancy}

\section*{Policies}
\begin{itemize}
  \item You are free to collaborate on all of the problems, subject to the collaboration policy stated in the syllabus.
  \item You should submit all code used in the homework.
        You are free to use Python, C/C++, Julia, or any other code \textbf{within reason} as long as you comment your code such that the TA can follow along and run it without any issues.
\end{itemize}

\section*{Submission Instructions}
\textbf{PLEASE NOTE} that there are two steps to submitting your Homework.
Both must be submitted by the deadline.

\begin{itemize}
  \item Please submit your report as a single .pdf file to Gradescope under ``Assignment 3 Draft" or ``Assignment 3 Corrections".
        \textbf{In the report, include any images generated by your code along with your answers to the questions.}
        For instructions specifically pertaining to the Gradescope submission process, see \url{https://www.gradescope.com/get_started#student-submission}.
  \item Please submit your code as a .zip archive to Gradescope under ``Assignment 3 Code Draft'' or ``Assignment 3 Code Corrections".
        The .zip file should contain all of your source code files.
\end{itemize}

\newpage
\section{Tunneling in the Double Potential Well Redux [30 Points]}
\materials{Week 4-5 lectures}

Again, consider the double potential well,
\begin{equation}
  V(x) =  \alpha x^4  - 2x^2 + \frac{1}{\alpha}
\end{equation}
where $x$ is the position of the particle, and we set $m=\hbar=1$ and $\alpha = 0.4$.

In the previous assignment, we approximated the ground state and first excited state.
In this assignment, we will directly solve for the eigenfunctions and eigenvalues.
We will then use the eigenfunctions to simulate the time evolution of the wave function and estimate the tunneling time.

\begin{problem}[10]
Solve for the two lowest energy eigenfunctions, $\phi_0(x)$ and $\phi_1(x)$, and eigenvalues, $E_0$ and $E_1$, of the discretized Hamiltonian operator $\hat H = -\frac{1}{2}\frac{\partial^2}{\partial x^2} + V(x)$ using the power method.
The discrete Hamiltonian should be a $(N_D+1)\times(N_D+1)$ matrix, where $N_D$ is the number of grid points.
You may set $N_D=600$, $x_{\min} = -4$, and $x_{\max} = 4$.
Plot the (properly normalized) ground state and first excited state eigenfunctions and eigenvalues.
Evaluate the energy gap $\Delta E = E_1 - E_0$ between the ground state and first excited state and the expected tunneling time $t_\mathrm{tunnel} = \pi/\Delta E$.
Compare your answers to the previous assignment and \href{http://doi.org/10.1103/PhysRevD.18.4767}{K. Banerjee and S. P. Bhatnagar, "Two-well oscillator", Phys. Rev. D 18, 4767 (1978)}.
\end{problem}

\begin{solution}
\end{solution}

\begin{problem}[10]
Calculate the time evolution of the particle's wave function from one minimum of the double well to the other from the numerical solution of the time-dependent Schr\"{o}dinger equation as follows.
Initialize the wave function as a linear combination of the ground state and first excited state eigenfunctions, such that it starts in one of the wells.
\begin{equation}
  \psi(x, t=0) = \frac{1}{\sqrt{2}}\left ( \phi_0(x) + \phi_1(x)\right ),
\end{equation}
where $\phi_0(x)= \psi_0(-x)$ is symmetric and $\phi_1(x) = -\phi_1(-x)$ is antisymmetric.
Calculate the time evolution over a period $T = 4t_\mathrm{tunnel}$ as
\begin{equation}
  \psi(x, t) = \frac{1}{\sqrt{2}}\left (e^{-iE_0t/\hbar} \phi_0(x) + e^{-iE_1t/\hbar}\phi_1(x)\right ),
\end{equation}
\end{problem}

\begin{solution}
\end{solution}

\begin{problem}[10]
Perform the same time evolution calculation, but with the Feynman path integral approach, as you did in the last assignment.
Animate the evolution of the probability $|\psi(x, t)|^2$ with both approaches as a function of time $t$ over a period $T = 4t_\mathrm{tunnel}$ and save it as a \texttt{.gif} or \texttt{.mp4} file.
Label the two approaches.
Comment on any differences you observe.
\end{problem}

\begin{solution}
\end{solution}


\newpage
\section{MCMC and 2D Ising Model [30 Points]}
\materials{Week 5-6 lectures}

Consider the 2D Ising model in a square lattice $\Lambda$ with $20\times 20$ sites and periodic boundary conditions.
The energy of the system for a given spin configuration $\sigma = \{\sigma_i\}_{i\in \Lambda}$ is
\begin{equation}
  E(\sigma) = -J\sum_{\langle ij\rangle} \sigma_i\sigma_j,
\end{equation}
where $\langle i j \rangle$ denotes two adjacent sites (with no double counting), $J$ is the spin-spin interaction, and $\sigma_i \in \{ -1, +1\}$ is the spin at site $i$.

The net magnetization of the system is
\begin{equation}
  M(\sigma) = \frac{1}{|\Lambda|}\sum_{i\in \Lambda} \sigma_i.
\end{equation}

The probability of a given configuration $\sigma$ is given by the Boltzmann distribution
\begin{equation}
  p(\sigma) = \frac{1}{Z}\exp \left(-\frac{E(\sigma)}{k_\mathrm{B}T}\right),
\end{equation}
where $Z = \sum_{\sigma} \exp \left(-\frac{E(\sigma)}{k_\mathrm{B}T}\right)$ is the partition function, $T$ is the temperature, and $k_\mathrm{B}$ is the Boltzmann constant.
For this problem, you may set $J=k_\mathrm{B}=1$.

\begin{problem}[10]
Use MCMC to simulate the 2D Ising model at temperature $T=2$ and calculate the net magnetization at each time step.
Try two initial configurations: one with all spins up and one with spins randomly up or down with equal probability.
Plot the net magnetization as a function of MCMC time steps.
What's a good number of ``burn-in'' steps for the two initial configurations?
What's a good number of total steps to get a good estimate of the magnetization?
\end{problem}

\begin{problem}[20]
Re-run the MCMC simulation for the 2D Ising model at temperatures $T=1$ to $4$ in steps of 0.2.
Describe your strategy for determining the initial configuration, burn-in steps, number of steps per chain, number of chains, and thinning (if any).

Plot the net magnetization and its standard deviation (as an error bar or band) as a function of temperature.
Compare to the theoretical prediction for the critical temperature $T_\mathrm{c}=\frac{2}{\ln(1+\sqrt{2})}\approx 2.269$ in units where $J=k_\mathrm{B}=1$.
Do you observe a sharp phase transition at the critical temperature? If not, what could be going wrong?
\end{problem}


\end{document}
