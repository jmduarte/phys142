\newif\ifshowsolutions
\showsolutionsfalse
\input{../common/preamble}

\chead{
  {\vbox{
      \vspace{2mm}
      \large
      Computational Physics II \hfill
      UCSD PHYS 142/242 \hfill \\[1pt]
      Assignment 1\hfill
      Draft version due: Friday, January 26, 2024, 8:00pm\\
	  \hfill
	  Corrected version due: Wednesday, January 31, 2024, 8:00pm\\
    }
  }
}

\begin{document}
\pagestyle{fancy}

\section*{Policies}
\begin{itemize}
  \item You are free to collaborate on all of the problems, subject to the collaboration policy stated in the syllabus.
  \item You should submit all code used in the homework.
        You are free to use Python, C/C++, Julia, or any other code \textbf{within reason} as long as you comment your code such that the TA can follow along and run it without any issues.
\end{itemize}

\section*{Submission Instructions}
\textbf{PLEASE NOTE} that there are two steps to submitting your Homework.
Both must be submitted by the deadline.

\begin{itemize}
  \item Please submit your report as a single .pdf file to Gradescope under ``Assignment 1 Draft" or ``Assignment 1 Corrections".
        \textbf{In the report, include any images generated by your code along with your answers to the questions.}
        For instructions specifically pertaining to the Gradescope submission process, see \url{https://www.gradescope.com/get_started#student-submission}.
  \item Please submit your code as a .zip archive to Gradescope under ``Assignment 1 Code Draft'' or ``Assignment 1 Code Corrections".
        The .zip file should contain all of your source code files.
\end{itemize}

\newpage
\section{Harmonic Oscillator Path Integral [50 Points]}
\materials{Week 1 lectures}

Consider the harmonic oscillator with Lagrangian,
\begin{equation}
  L(x, \dot{x}) = K(\dot{x}) - V(x) = \frac{1}{2}\dot{x}^2 - \frac{1}{2}x^2,
\end{equation}
where $x$ is the position of the oscillator and $\dot{x}$ is its velocity.
Note this is expressed in units where the mass $m=1$ and angular frequency $\omega=1$, so the classical oscillator period $T_0 = 2\pi$.
For this problem, you can work in units $m = \omega = \hbar = 1$, so the classical oscillator period $T_0 = 2\pi$.

We will use the discrete approximation to the path integral for the harmonic oscillator, where the time step is $\epsilon = \Delta t = T_0/128$.
The electron position is also discretized into $N_D+1$ possible points, $x_0 = -4, x_1, x_2, \ldots, x_{N_D} = +4$, where $N_D=600$.
The initial probability amplitude (sometimes called the wavefunction) of the electron is a Gaussian centered at $x_\mathrm{start}$,
\begin{equation}
  \Psi_0(x) = \left(\frac{\alpha}{\pi}\right)^{1/4}\exp\left(-\frac{\alpha}{2}(x-x_\mathrm{start})^2\right),
\end{equation}
where $\alpha = 2$ and $x_\mathrm{start} = 3/4$.
The amplitude can be represented as a vector $\psi_0$ with $N_D+1$ components, $\psi_0 = (\Psi_0(x_0), \Psi_0(x_1), \ldots, \Psi_0(x_{N_D}))$.
We recommend using complex NumPy arrays, e.g. \texttt{np.array([1+2j, 3+4j])} and \texttt{np.zeros((10, 10), dtype=np.complex64))}.

\begin{problem}[10]
Calculate the propagator matrix $\mathcal K_{8\epsilon}$ for a time period $T_0/16 = 8\epsilon$ (8 time steps) built from the elementary propagator matrix $\mathcal K_\epsilon$ for a single $\epsilon=\Delta t=T_0/128$ time step.

Recall we gave the general form of the propagator in lecture as
\begin{equation}
  \mathcal K(x_b, t_b; x_a, t_a) = \left(\frac{m\omega}{2\pi i \hbar\ \mathrm{sin}(\omega(t_b - t_a))}\right )^{1/2} \exp \left(\frac{i m \omega}{2 \hbar\ \mathrm{sin}(\omega(t_b - t_a))} [(x_a^2 + x_b^2)\ \mathrm{cos}(\omega(t_b - t_a)) - 2 x_a x_b]\right)
\end{equation}
where $x_a$ and $x_b$ are the initial and final positions, respectively, and $t_a$ and $t_b$ are the initial and final times, respectively.

Use NumPy to print the matrix (default truncated output) and copy the (truncated) output into your report.
Note by default if \texttt{K_8eps} is a large NumPy array, \texttt{print(K_8eps)} prints the first 3 and last 3 elements along each axis.

\begin{hint} The elementary propagator matrix $\mathcal K_\epsilon$ is an $(N_D+1)\times(N_D+1)$-dimensional complex matrix that time evolves the state $\psi$ by one time step, and
  \begin{equation}
    \mathcal K_{t} = (\Delta x)^{N-1} \mathcal K_\epsilon^N
  \end{equation}
  time evolves the state by $N$ time steps, where $N\epsilon = t$.
\end{hint}
\end{problem}

\begin{solution}
\end{solution}

\begin{problem}[10]
Evolve the probability amplitude of the electron with $T_0/16$ time steps and measure its mean position $\langle x \rangle$ as a function of time.
Make a graph showing $\langle x \rangle$ versus time $t$.
Label the axes.

\begin{hint}
  Recall
  \begin{equation}
    \langle x \rangle = \int x P_t(x) dx
  \end{equation}
  where $P_t(x) = |\Psi_t(x)|^2$ is the probability density function at time $t$.
\end{hint}
\end{problem}

\begin{solution}
\end{solution}

\begin{problem}[10]
Calculate the mean energy $\langle E \rangle$, mean kinetic energy $\langle K \rangle$, and mean potential energy $\langle V \rangle$ as a function of time.
Make one graph showing all three with a legend labeling them.

\begin{hint}
  Recall $E = K + V$ and for the mean value of $V$, we have
  \begin{equation}
    \langle V\rangle = \int \frac{1}{2}x^2 P_t(x) dx.
  \end{equation}
  For the mean value of $K$, there are a few different ways to calculate it.
  We will give one way here, but you are free to use another method.
  \begin{equation}
  \langle K\rangle = \int \int \frac{1}{2} \left(\frac{x' - x}{\epsilon}\right)^2 |K(x', t+\epsilon, x, t)|^2 P_t(x) dx' dx
  \end{equation}
  \end{hint}
\end{problem}

\begin{solution}
\end{solution}

\begin{problem}[10]
Calculate the time evolution of the probability amplitude at times $mT_0/16$ for $m=1, \dots, 8$.
Make a single graph showing the probability amplitudes initially and at those eight times, with a legend labeling them.
Optional: Superimpose the potential V(x) and  amplitudes at those eight times on the same graph as the probability density function $P_t(x) = |\Psi_t(x)|^2$ at those eight times.
\end{problem}

\begin{solution}
\end{solution}

\begin{problem}[10]
Animate the time evolution of the probability amplitude over the full time period $T_0 = 2\pi$.
Each frame should correspond to one time step of $\epsilon = T_0/128$ (so $128+1$ frames total).
Save the animation as a .gif or .mp4 file.
\end{problem}

\begin{solution}
\end{solution}

\end{document}
