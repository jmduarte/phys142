

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Lab 3: Introduction to Julia &#8212; UCSD PHYS 142/242</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'labs/lab3/Lab3';</script>
    <link rel="canonical" href="https://jduarte.physics.ucsd.edu/phys142/labs/lab3/Lab3.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab 4: Free Particle Propagator (Assignment 1 Tutorial)" href="../lab4/Lab4.html" />
    <link rel="prev" title="Lab 2: Numba and ffmpeg" href="../lab2/Lab2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/Interference_electrons_double-slit_at_10cm.png" class="logo__image only-light" alt="UCSD PHYS 142/242 - Home"/>
    <script>document.write(`<img src="../../_static/Interference_electrons_double-slit_at_10cm.png" class="logo__image only-dark" alt="UCSD PHYS 142/242 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    UCSD PHYS 142/242: Computational Physics II (Winter 2025)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/syllabus.pdf">Syllabus</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/01_Introduction.pdf">Lecture 01: Introduction</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/labs/lab1/01_DataHub.pdf">Lab 01: DataHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab1/Lab1.html">Lab 1: Introduction</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/02_FeynmanPathIntegral.pdf">Lecture 02: Feynman Path Integral</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab2/Lab2.html">Lab 2: Numba and ffmpeg</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/quiz1.pdf">Quiz 01</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/03_FeynmanPathIntegralContinued.pdf">Lecture 03: Feynman Path Integral (Continued)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 3: Introduction to Julia</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/04_FreeParticle.pdf">Lecture 04: Free Particle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab4/Lab4.html">Lab 4: Free Particle Propagator (Assignment 1 Tutorial)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/05_HarmonicOscillator.pdf">Lecture 05: Harmonic Oscillator</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/quiz2.pdf">Quiz 02</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/06_SchrodingerEquation.pdf">Lecture 06: Schrodinger Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab5/lab05.html">Lab 5: Git/GitHub Tutorial</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/07_UnitarityPropagatorTraceContinued.pdf">Lecture 07: Unitarity and Propagator Trace</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/assignment1.pdf">Assignment 01</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/08_UnitarityPropagatorTraceContinued.pdf">Lecture 08: Unitarity and Propagator Trace (Continued)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/09_DoubleWellTunneling.pdf">Lecture 09: Double Well and Tunneling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab8/Lab8.html">Lab 8: Assignment 2 Tutorial</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/10_EigenvalueProblem.pdf">Lecture 10: Eigenvalue Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/10_EigenvalueProblemDemo.html">Lecture 10: Eigenvalue Problem Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/11_StatMechRecap.pdf">Lecture 11: Statistical Mechanics Recap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab9/Lab9.html">Lab 9: Eigenvalue Problem Demo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/13_MCMC.pdf">Lecture 13: Markov chain Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/assignment2.pdf">Assignment 02</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/14_MCMC_Continued.pdf">Lecture 14: Markov chain Monte Carlo (Continued)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/15_Ising_Model.pdf">Lecture 15: Ising Model and MCMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab12/Lab12.html">Lab 12: MCMC Tutorial</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/16_Path_Integral_MCMC.pdf">Lecture 16: Path Integral and MCMC</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/17_Path_Integral_MCMC_Continued.pdf">Lecture 17: Path Integral and MCMC (Continued)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab15/Lab15.html">Lab 15: MCMC for Feynman Path Integral Tutorial</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/assignment3.pdf">Assignment 03</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/18_Particle_Physics_VEGAS.pdf">Lecture 18: Particle Physics and VEGAS</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/19_Particle_Physics_VEGAS_Continued.pdf">Lecture 19: Particle Physics and VEGAS (Continued)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab17/lab17.html">Lab 17: VEGAS Tutorial</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/20_Particle_Physics_VEGAS_Part3.pdf">Lecture 20: Particle Physics and VEGAS (Part 3)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/22_Final_Projects.pdf">Lecture 22: Final Projects</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/lectures/23_Preview_139.pdf">Lecture 23: Preview of PHYS 139</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 10</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://jduarte.physics.ucsd.edu/phys142/final_projects.pdf">Final Projects</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jmduarte/phys142/main?urlpath=tree/labs/lab3/Lab3.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://datahub.ucsd.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/jmduarte/phys142&urlpath=tree/phys142/labs/lab3/Lab3.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/jmduarte/phys142/blob/main/labs/lab3/Lab3.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jmduarte/phys142" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jmduarte/phys142/issues/new?title=Issue%20on%20page%20%2Flabs/lab3/Lab3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/labs/lab3/Lab3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 3: Introduction to Julia</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-numba">Python (Numba)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#julia">Julia</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-basics">Array basics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-multiplication">Matrix multiplication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intro-to-monte-carlo-simulation">Intro to Monte Carlo Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#under-the-hood">Under the hood</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-3-introduction-to-julia">
<h1>Lab 3: Introduction to Julia<a class="headerlink" href="#lab-3-introduction-to-julia" title="Permalink to this heading">#</a></h1>
<p>There are traditionally two categories of computer languages: Compiled (C/C++, Fortran) and Interpreted (Python, R).</p>
<p>Julia language has inherited the advantage from both categories.</p>
<p>Some helpful links:</p>
<ul class="simple">
<li><p>Julia documentation (<a class="reference external" href="https://julialang.org/">https://julialang.org/</a>)</p></li>
<li><p>Julia analysis demo at PyHEP 2023 (<a class="github reference external" href="https://github.com/Moelf/PyHEP_2023_JuliaDemo/blob/main/Julia_analysis_demo.ipynb">Moelf/PyHEP_2023_JuliaDemo</a>)</p></li>
<li><p>Talk (<a class="reference external" href="https://jiling.web.cern.ch/jiling/dump/2021_Harvard_JuliaHEP.html">https://jiling.web.cern.ch/jiling/dump/2021_Harvard_JuliaHEP.html</a>)</p></li>
</ul>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading">#</a></h2>
<p><img alt="" src="../../_images/julia_comparison.png" />
Ref: <a class="reference external" href="https://arxiv.org/abs/2109.09973">https://arxiv.org/abs/2109.09973</a></p>
<p>Julia is a solution to the “two-language problem,” e.g. using writing performant C++ code and a high-level Python wrapper.</p>
<p>Consider this function taken from Numba’s introduction. Numba is great because:</p>
<ul class="simple">
<li><p>you don’t write C++</p></li>
<li><p>you can write fast loop!</p></li>
</ul>
<section id="python-numba">
<h3>Python (Numba)<a class="headerlink" href="#python-numba" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>@jit(nopython=True)
def go_fast(a):
    trace = 0.0
    for i in range(a.shape[0]):
        trace += np.tanh(a[i, i])
    return a + trace

In [2]: x = np.arange(100).reshape(10, 10)
In [3]: %timeit go_fast(x)
814 ns ± 5.2 ns (mean ± σ)    # Numba
16500 ns ± 70.5 ns (mean ± σ) # CPython
</pre></div>
</div>
<p>but it does have draw back (all JIT x Python solutions do): it’s not compatible with all Python.</p>
<p>the Julia “sale” is that:</p>
<ul class="simple">
<li><p>you still avoid C++</p></li>
<li><p>you can write fast anything!*</p></li>
<li><p>there’s no compatibility issue and “unhandled” construct, it’s just the language itself</p></li>
</ul>
</section>
<section id="julia">
<h3>Julia<a class="headerlink" href="#julia" title="Permalink to this heading">#</a></h3>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">go_faster</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="w">    </span><span class="n">trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">axes</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">trace</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">tanh</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">])</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">.+</span><span class="w"> </span><span class="n">trace</span>
<span class="k">end</span>
<span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">99</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="nd">@benchmark</span><span class="w"> </span><span class="n">go_faster</span><span class="p">(</span><span class="o">$</span><span class="n">x</span><span class="p">)</span>
<span class="mf">158.947</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="o">±</span><span class="w"> </span><span class="mf">100.451</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">±</span><span class="w"> </span><span class="n">σ</span><span class="p">)</span><span class="w"> </span><span class="c"># σ due to GC</span>
</pre></div>
</div>
</section>
</section>
<section id="array-basics">
<h2>Array basics<a class="headerlink" href="#array-basics" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># A function makerandom with two methods is declared.</span>
<span class="c"># This looks just like two functions with the same name but with different arguments.</span>
<span class="c"># An array r with n Float64 elements is declared; element i is referred to as r[i].</span>
<span class="c"># The Base function round(T,m) rounds the number m to the closest integer and converts to type T (here Int)</span>
<span class="c"># The Base function rand() generates (when given no arguments) a random Float64 in [0,1).</span>
<span class="c"># The functional difference between the methods is Float64 (first) vs Float32 (second) numbers returned.</span>
<span class="c"># In the second method r[i]=rand() implies a loss of precision from 64 to 32 bit Float.</span>

<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">makerandom</span><span class="p">(</span><span class="n">n</span><span class="o">::</span><span class="kt">Int</span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="o">=</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}(</span><span class="nb">undef</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">       </span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">rand</span><span class="p">()</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">r</span>
<span class="w"> </span><span class="k">end</span>

<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">makerandom</span><span class="p">(</span><span class="n">m</span><span class="o">::</span><span class="kt">Float64</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="o">=</span><span class="n">round</span><span class="p">(</span><span class="kt">Int</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="o">=</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float32</span><span class="p">}(</span><span class="nb">undef</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">       </span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">rand</span><span class="p">()</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">r</span>
<span class="w"> </span><span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>makerandom (generic function with 2 methods)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># The function is called twice, with different arguments (example of multiple dispatch).</span>
<span class="c"># In each case 5 times; n is assigned an integer-constant value, type will be Int (Int64).</span>
<span class="c"># The Base function convert(Float64,n) converts the integer n to a Float64.</span>

<span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="n">convert</span><span class="p">(</span><span class="kt">Float64</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

<span class="c"># The function is called with Int argument (first method dispatched)</span>
<span class="c"># a will be the 5-element Float64 array returned by the function</span>

<span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="n">makerandom</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s">&quot;  &quot;</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w"> </span><span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.09411252840062967
2  0.0108072814783724
3  0.6817531417860903
4  0.652045764128776
5  0.8234837982264
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># The function is called with Float64 argument (second method dispatched)</span>
<span class="c"># b will be the 5-element Float32 array returned by the function</span>

<span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="n">makerandom</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s">&quot;  &quot;</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w"> </span><span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.26737255
2  0.013948989
3  0.60287315
4  0.39981413
5  0.6088479
</pre></div>
</div>
</div>
</div>
</section>
<section id="matrix-multiplication">
<h2>Matrix multiplication<a class="headerlink" href="#matrix-multiplication" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># This function creates an n*n random matrix (similar to randomarray.jl but 2-dim array)</span>

<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">randmatrix</span><span class="p">(</span><span class="n">n</span><span class="o">::</span><span class="kt">Int</span><span class="p">)</span>
<span class="w">    </span><span class="n">mat</span><span class="o">=</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}(</span><span class="nb">undef</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">          </span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">rand</span><span class="p">()</span>
<span class="w">       </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">mat</span>
<span class="w"> </span><span class="k">end</span>

<span class="c"># Ask for matrix size and read it (stdin = standard input) using readline</span>
<span class="c"># Text input has to be parsed to a type (here Int)</span>

<span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Give matrix size&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Give matrix size
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Create two random matrices and their product</span>
<span class="c"># Note that &quot;*&quot; is actual matrix multiplication</span>

<span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="n">randmatrix</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w"> </span><span class="n">b</span><span class="o">=</span><span class="n">randmatrix</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">b</span>

<span class="c"># print the results</span>

<span class="w"> </span><span class="n">println</span><span class="p">()</span>
<span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;A, B, A*B&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="s">&quot;  &quot;</span><span class="p">,</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="s">&quot;  &quot;</span><span class="p">,</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">])</span>
<span class="w"> </span><span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A, B, A*B
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.3467715719876312, 0.7238614134325188, 0.05506714791352629]  [0.4179709850738056, 0.2729078441331676, 0.26127326634376646]  [0.3124956897820997, 0.6308146269306132, 0.5206262005002662]
[0.5887617282288764, 0.3699430467288307, 0.2778759715255368]  [0.20580213886561127, 0.6653513151689086, 0.569977556194945]  [0.4159926542397345, 0.6821154372521158, 0.45268790230275785]
[0.19719268930511058, 0.6814723756387202, 0.3318099532448555]  [0.33746086042665646, 0.9907141272527589, 0.3166915378874342]  [0.3346421674026255, 0.835962781342338, 0.5450265416942499]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Element-by-element operations can be done with &quot;.&quot; added to operator</span>
<span class="c"># Here element-by-element multiplication</span>

<span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="o">.*</span><span class="n">b</span>
<span class="w"> </span><span class="n">println</span><span class="p">()</span>
<span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;A, B, A elements multiplied by B elements&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="s">&quot;  &quot;</span><span class="p">,</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="s">&quot;  &quot;</span><span class="p">,</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">])</span>
<span class="w"> </span><span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A, B, A elements multiplied by B elements
[0.3467715719876312, 0.7238614134325188, 0.05506714791352629]  [0.4179709850738056, 0.2729078441331676, 0.26127326634376646]  [0.1449404555392623, 0.19754745779105623, 0.014387573603602339]
[0.5887617282288764, 0.3699430467288307, 0.2778759715255368]  [0.20580213886561127, 0.6653513151689086, 0.569977556194945]  [0.12116842295171651, 0.2461420926786205, 0.15838306717542155]
[0.19719268930511058, 0.6814723756387202, 0.3318099532448555]  [0.33746086042665646, 0.9907141272527589, 0.3166915378874342]  [0.06654481460274896, 0.675144309877779, 0.10508140437947093]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Matrix inverse using Base function inv()</span>
<span class="c"># Multiply inverse of A by A to check if OK</span>

<span class="w"> </span><span class="n">b</span><span class="o">=</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">b</span>
<span class="w"> </span><span class="n">println</span><span class="p">()</span>
<span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;A, 1/A, A*(1/A)&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="s">&quot;  &quot;</span><span class="p">,</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="s">&quot;  &quot;</span><span class="p">,</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">])</span>
<span class="w"> </span><span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A, 1/A, A*(1/A)
[0.3467715719876312, 0.7238614134325188, 0.05506714791352629]  [0.6239018588004046, 1.8980766628802936, -1.6930968681802385]  [1.0, -6.938893903907228e-18, 8.326672684688674e-17]
[0.5887617282288764, 0.3699430467288307, 0.2778759715255368]  [1.3164921437716413, -0.9759614256020805, 0.5988390636248597]  [2.220446049250313e-16, 1.0, -1.1102230246251565e-16]
[0.19719268930511058, 0.6814723756387202, 0.3318099532448555]  [-3.074597082301051, 0.8764170777046324, 2.790073161830853]  [2.220446049250313e-16, -1.1102230246251565e-16, 1.0]
</pre></div>
</div>
</div>
</div>
</section>
<section id="intro-to-monte-carlo-simulation">
<h2>Intro to Monte Carlo Simulation<a class="headerlink" href="#intro-to-monte-carlo-simulation" title="Permalink to this heading">#</a></h2>
<p>In physics, the term ”Monte Carlo” refers to the use of random numbers. Monte
Carlo integration is the simplest of a wide range of ”Monte Carlo methods”, where averages are
calculated using uniform random sampling.</p>
<p>Monte Carlo simulation methods are related to the elementary Monte Carlo integration methods that we are discussing here, but are based on more efficient non-uniform sampling schemes. We will learn more about the detail in the later part of this course.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Calculates pi using a circle with radius r=1/2 (slightly faster than r=1) by MC sampling.</span>

<span class="k">function</span><span class="w"> </span><span class="n">pionebin</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="c"># samples and computes the average for one bin with n points</span>
<span class="w">   </span><span class="n">sum</span><span class="o">=</span><span class="mi">0</span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="n">x2</span><span class="o">=</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="w">      </span><span class="n">y2</span><span class="o">=</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">x2</span><span class="o">+</span><span class="n">y2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span>
<span class="w">         </span><span class="n">sum</span><span class="o">=</span><span class="n">sum</span><span class="o">+</span><span class="mi">1</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">   </span><span class="k">end</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mf">4.0</span><span class="o">*</span><span class="n">sum</span><span class="o">/</span><span class="n">n</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pionebin (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">samplepi</span><span class="p">(</span><span class="n">nbin</span><span class="p">,</span><span class="n">nsamp</span><span class="p">)</span><span class="w">  </span><span class="c"># Doing MC sampling of nbin bins, each sampling nsamp points</span>
<span class="w">   </span><span class="n">av</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">   </span><span class="n">er</span><span class="o">=</span><span class="mf">0.</span><span class="w">    </span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">nbin</span>
<span class="w">      </span><span class="n">p</span><span class="o">=</span><span class="n">pionebin</span><span class="p">(</span><span class="n">nsamp</span><span class="p">)</span>
<span class="w">      </span><span class="n">av</span><span class="o">=</span><span class="n">av</span><span class="o">+</span><span class="n">p</span>
<span class="w">      </span><span class="n">er</span><span class="o">=</span><span class="n">er</span><span class="o">+</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span>
<span class="w">      </span><span class="n">println</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="s">&quot;   &quot;</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<span class="w">   </span><span class="k">end</span>
<span class="w">   </span><span class="n">av</span><span class="o">=</span><span class="n">av</span><span class="o">/</span><span class="n">nbin</span>
<span class="w">   </span><span class="n">er</span><span class="o">=</span><span class="n">er</span><span class="o">/</span><span class="n">nbin</span>
<span class="w">   </span><span class="n">er</span><span class="o">=</span><span class="p">((</span><span class="n">er</span><span class="o">-</span><span class="n">av</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nbin</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mf">0.5</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">av</span><span class="p">,</span><span class="n">er</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>samplepi (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">nbin</span><span class="o">=</span><span class="mi">10</span>
<span class="n">nsamp</span><span class="o">=</span><span class="mi">10000</span>

<span class="n">ap</span><span class="p">,</span><span class="n">ep</span><span class="o">=</span><span class="n">samplepi</span><span class="p">(</span><span class="n">nbin</span><span class="p">,</span><span class="n">nsamp</span><span class="p">)</span>

<span class="n">println</span><span class="p">()</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;Final result and error:   &quot;</span><span class="p">,</span><span class="n">ap</span><span class="p">,</span><span class="s">&quot;   &quot;</span><span class="p">,</span><span class="n">ep</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1   3.154
2   3.1384
3   3.13
4   3.15
5   3.1544
6   3.1572
7   3.142
8   3.1444
9   3.1764
10   3.1424

Final result and error:   3.14892   0.004027924748283986
</pre></div>
</div>
</div>
</div>
</section>
<section id="under-the-hood">
<h2>Under the hood<a class="headerlink" href="#under-the-hood" title="Permalink to this heading">#</a></h2>
<p>Julia is able to show us what is happening “under the hood”</p>
<p><img alt="" src="../../_images/julia_compiler.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>f (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@code_typed</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CodeInfo(
1 ─ %1 = Base.sitofp(Float64, x)<span class=" -Color -Color-Cyan">::Float64</span>
│   %2 = invoke Base.Math.cos(%1::Float64)<span class=" -Color -Color-Cyan">::Float64</span>
│   %3 = Base.mul_int(2, x)<span class=" -Color -Color-Cyan">::Int64</span>
│   %4 = Base.sitofp(Float64, %3)<span class=" -Color -Color-Cyan">::Float64</span>
│   %5 = Base.add_float(%2, %4)<span class=" -Color -Color-Cyan">::Float64</span>
└──      return %5
) =&gt; Float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@code_llvm</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>;  @ In[11]:1 within `f&#39;
define <span class=" -Color -Color-Cyan">double</span> @julia_f_1630<span class=" -Color -Color-Yellow">(</span><span class=" -Color -Color-Cyan">i64</span> signext %0<span class=" -Color -Color-Yellow">)</span> <span class=" -Color -Color-Yellow">{</span>
top:
;  @ In[11]:2 within `f&#39;
; ┌ @ math.jl:405 within `cos&#39;
; │┌ @ float.jl:206 within `float&#39;
; ││┌ @ float.jl:191 within `AbstractFloat&#39;
; │││┌ @ float.jl:94 within `Float64&#39;
      %1 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>= <span class=" -Color -Color-Bold">sitofp</span> <span class=" -Color -Color-Cyan">i64</span> %0 to <span class=" -Color -Color-Cyan">double</span>
; └└└└
; ┌ @ math.jl:407 within `cos&#39;
   %2 = <span class=" -Color -Color-Bold">call</span> <span class=" -Color -Color-Cyan">double</span> @j_cos_1632<span class=" -Color -Color-Yellow">(</span><span class=" -Color -Color-Cyan">double</span> %1<span class=" -Color -Color-Yellow">)</span>
; └
; ┌ @ int.jl:88 within `*&#39;
   %3 = <span class=" -Color -Color-Bold">shl</span> <span class=" -Color -Color-Cyan">i64</span> %0, <span class=" -Color -Color-Yellow">1</span>
; └
; ┌ @ promotion.jl:321 within `+&#39;
; │┌ @ promotion.jl:292 within `promote&#39;
; ││┌ @ promotion.jl:269 within `_promote&#39;
; │││┌ @ number.jl:7 within `convert&#39;
; ││││┌ @ float.jl:94 within `Float64&#39;
       %4 = <span class=" -Color -Color-Bold">sitofp</span> <span class=" -Color -Color-Cyan">i64</span> %3 to <span class=" -Color -Color-Cyan">double</span>
; │└└└└
; │ @ promotion.jl:321 within `+&#39; @ float.jl:326
   %5 = <span class=" -Color -Color-Bold">fadd</span> <span class=" -Color -Color-Cyan">double</span> %2, %4
; └
  <span class=" -Color -Color-Bold">ret</span> <span class=" -Color -Color-Cyan">double</span> %5
<span class=" -Color -Color-Yellow">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@code_native</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	.text
; ┌ @ In[11]:1 within `f&#39;
	<span class=" -Color -Color-Bold">pushq</span>	%rbx
	<span class=" -Color -Color-Bold">movq</span>	%rdi, %rbx
; │ @ In[11]:2 within `f&#39;
; │┌ @ math.jl:405 within `cos&#39;
; ││┌ @ float.jl:206 within `float&#39;
; │││┌ @ float.jl:191 within `AbstractFloat&#39;
; ││││┌ @ float.jl:94 within `Float64&#39;
	<span class=" -Color -Color-Bold">vcvtsi2sd</span>	%rdi, %xmm0, %xmm0
; │└└└└
; │┌ @ math.jl:407 within `cos&#39;
	<span class=" -Color -Color-Bold">movabsq</span>	$cos, %rax
	<span class=" -Color -Color-Bold">callq</span>	*%rax
; │└
; │┌ @ int.jl:88 within `*&#39;
	<span class=" -Color -Color-Bold">addq</span>	%rbx, %rbx
; │└
; │┌ @ promotion.jl:321 within `+&#39;
; ││┌ @ promotion.jl:292 within `promote&#39;
; │││┌ @ promotion.jl:269 within `_promote&#39;
; ││││┌ @ number.jl:7 within `convert&#39;
; │││││┌ @ float.jl:94 within `Float64&#39;
	<span class=" -Color -Color-Bold">vcvtsi2sd</span>	%rbx, %xmm1, %xmm1
; ││└└└└
; ││ @ promotion.jl:321 within `+&#39; @ float.jl:326
	<span class=" -Color -Color-Bold">vaddsd</span>	%xmm1, %xmm0, %xmm0
; │└
	<span class=" -Color -Color-Bold">popq</span>	%rbx
	<span class=" -Color -Color-Bold">retq</span>
	<span class=" -Color -Color-Bold">nopw</span>	%cs:<span class=" -Color -Color-Yellow">(</span>%rax,%rax<span class=" -Color -Color-Yellow">)</span>
	<span class=" -Color -Color-Bold">nopl</span>	<span class=" -Color -Color-Yellow">(</span>%rax<span class=" -Color -Color-Yellow">)</span>
; └
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.6"
        },
        kernelOptions: {
            name: "julia-1.6",
            path: "./labs/lab3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.6'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../lab2/Lab2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 2: Numba and ffmpeg</p>
      </div>
    </a>
    <a class="right-next"
       href="../lab4/Lab4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 4: Free Particle Propagator (Assignment 1 Tutorial)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-numba">Python (Numba)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#julia">Julia</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-basics">Array basics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-multiplication">Matrix multiplication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intro-to-monte-carlo-simulation">Intro to Monte Carlo Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#under-the-hood">Under the hood</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Javier Duarte
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>